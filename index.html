<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
       
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/static/css/bootstrap.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="144x144" href="/public/apple-touch-icon.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="" href="/atom.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home" class='logo'></a>
          <nav class="pull toggle-content">
            <ul class="top-nav">
              
              <li><h2><a href="/archive">Archive</a></h2></li>
              
              <li><h2><a href="/atom.xml">Feed</a></h2></li>
              
            </ul>
          </nav>
          <div class="text-right navicon">
            <a id="nav-toggle" class="nav_slide_button" href="#"><span></span></a>
          </div>
        </h3>
      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2023/01/29/Exploring-the-Overlays-Capture-Architecture/">
        Exploring the Overlays Capture Architecture: Managing Data Captured from Temperature Sensors
      </a>
    </h1>

    <time datetime="2023-01-29T17:27:05+00:00" class="post-date">29 Jan 2023</time>
    
    <p class="post-author">
    by
    
    Marcin Olichwiruk
    
    </p>
    

    <p>This article will look at how to parse OCA (Overlays Capture Architecture) from an Excel template and convert it into OCA Bundle, a zip archive file. We will also describe the files included in the zip archive and show how to read the meta.json file. Additionally, we will demonstrate how to verify the integrity of the OCA Bundle and validate the captured data. Finally, we will look at transforming the units of captured data from Celsius to Kelvin. By the end of this article, you will have a better understanding of the OCA system and how to work with OCA data.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>To follow described OCA exploration, you will need the OCA Bundle file. To get one, you can:</p>
<ul>
  <li>generate it from the XLS template. To do this, download the prepared <a href="https://data-vault.argo.colossi.network/api/v1/files/EsWbDUorzNF1wv2cryD_fToNDhax7APLVN3Q2EAxeqRU">oca_bundle.xlsx</a> file with defined OCA for capturing data from a temperature sensor. Then, the <a href="https://oca.colossi.network/ecosystem/oca-parser.html">OCA Parser</a> is used to convert the XLS file into OCA Bundle as a zip archive. The command to do this is:
 <code class="language-plaintext highlighter-rouge">./parser parse oca -p ./oca_bundle.xlsx --zip</code></li>
  <li><a href="https://data-vault.argo.colossi.network/api/v1/files/EukCvvhAim2elMtOMMIs3bwPf4fbvQzZswl3TyEGaNrA">download</a> pre-generated OCA Bundle file directly</li>
</ul>

<p>In either case, once you have obtained an OCA Bundle, you can begin exploring the structure and contents of the bundle and working with the data contained in it.</p>

<h2 id="under-the-hood">Under the hood</h2>
<p>Let’s see what the generated zip archive contains:
<code class="language-plaintext highlighter-rouge">unzip -l oca_bundle.zip</code>
This will produce output similar to the following:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>Archive:  oca_bundle.zip
  Length      Name
<span class="nt">---------</span>   <span class="nt">----</span>
      190   EmL-JD22a1RywPXzzZLAEOxR8NHSi-04pQnOhNwHG7sg.json
      277   EmYQZgAnoE_AIsOiZHL17jw7KGnYgY1pPRFfSUnVYUj0.json
      213   EATuKGoJosYKLyLvdNBXpFM2YeuKuzvthOHu08whWWmA.json
      275   meta.json
<span class="nt">---------</span>   <span class="nt">-------</span>
      955   4 files
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The zip archive contains several JSON-formatted files, including overlays and capture base files, that comprise the OCA Bundle. Furthermore, there is a <code class="language-plaintext highlighter-rouge">meta.json</code> file, a JSON-formatted file containing information about the other files in the zip archive. This file can be used to navigate through the OCA Bundle and access the overlays and other data collected in the archive.</p>

<h2 id="reading-the-metajson-file">Reading the meta.json file</h2>
<p><code class="language-plaintext highlighter-rouge">cat meta.json</code> will produce the following output:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"EmL-JD22a1RywPXzzZLAEOxR8NHSi-04pQnOhNwHG7sg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"character_encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EmYQZgAnoE_AIsOiZHL17jw7KGnYgY1pPRFfSUnVYUj0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EATuKGoJosYKLyLvdNBXpFM2YeuKuzvthOHu08whWWmA"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"root"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EmL-JD22a1RywPXzzZLAEOxR8NHSi-04pQnOhNwHG7sg"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">files</code> attribute is a JSON object that maps the names of the overlays, bounded to capture base defined by a unique identifier (SAI) as key, and files to the SAI of the file within the OCA Bundle.</p>

<p>The <code class="language-plaintext highlighter-rouge">root</code> value references the top-level <code class="language-plaintext highlighter-rouge">capture_base</code> in the OCA Bundle. This <code class="language-plaintext highlighter-rouge">capture_base</code> is the starting point for traversing OCA when it contains attributes that refer to other OCAs, but it’s not covered in this article. If you are interested in investigating this topic further, you can read more about <a href="https://oca.colossi.network/specification/#attribute-type">reference attribute type</a> in the OCA documentation.</p>

<h2 id="verify-oca-bundle-integrity">Verify OCA Bundle Integrity</h2>
<p>The following code examples demonstrate how to verify the integrity of an OCA Bundle, a zip archive containing data captured by the Overlays Capture Architecture (OCA) system.</p>

<p>JavaScript:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Validator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">oca.js</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">resolveFromZip</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">oca.js-form-core</span><span class="dl">'</span>

<span class="kd">const</span> <span class="nx">oca</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">resolveFromZip</span><span class="p">(</span><span class="nx">ocaBundleFile</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">validator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Validator</span><span class="p">()</span>
<span class="nx">validator</span><span class="p">.</span><span class="nx">validate</span><span class="p">(</span><span class="nx">oca</span><span class="p">)</span> <span class="c1">// { success: boolean, errors: string[] }</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Rust:</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">oca_rust</span><span class="p">::</span><span class="nn">state</span><span class="p">::{</span><span class="nn">oca</span><span class="p">::</span><span class="n">OCA</span><span class="p">,</span> <span class="nn">validator</span><span class="p">::{</span><span class="n">Validator</span><span class="p">,</span> <span class="n">Error</span><span class="p">}};</span>
<span class="k">use</span> <span class="nn">oca_zip_resolver</span><span class="p">::</span><span class="n">resolve_from_zip</span><span class="p">;</span>

<span class="k">let</span> <span class="n">oca</span> <span class="o">=</span> <span class="nf">resolve_from_zip</span><span class="p">(</span><span class="s">"path/to/oca_bundle.zip"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">validator</span> <span class="o">=</span> <span class="nn">Validator</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
<span class="n">validator</span><span class="nf">.validate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">oca</span><span class="p">);</span> <span class="c1">// Result&lt;(), Vec&lt;Error&gt;&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The code uses the <code class="language-plaintext highlighter-rouge">resolveFromZip</code> method to load the OCA Bundle from the file system. This function returns an <a href="#OCA-object-with-Form-and-Credential-overlays-ignored">OCA object</a> representing the OCA data in the zip archive. Then creates a <code class="language-plaintext highlighter-rouge">Validator</code> object to perform the validation. The <code class="language-plaintext highlighter-rouge">validate</code> method of the <code class="language-plaintext highlighter-rouge">Validator</code> is then called on the OCA object to perform the validation.</p>

<p>In the JavaScript example, the <code class="language-plaintext highlighter-rouge">validate</code> method returns an object with a <code class="language-plaintext highlighter-rouge">success</code> property, which indicates whether the validation was successful, and an <code class="language-plaintext highlighter-rouge">errors</code> property, which is an array of error messages if the validation failed.
In the Rust example, the <code class="language-plaintext highlighter-rouge">validate</code> method returns a <code class="language-plaintext highlighter-rouge">Result</code> object, with <code class="language-plaintext highlighter-rouge">Ok</code> if the validation was successful, or <code class="language-plaintext highlighter-rouge">Err</code> with a vector of <code class="language-plaintext highlighter-rouge">Error</code> objects if the validation failed.</p>

<p>In both cases, the <code class="language-plaintext highlighter-rouge">Validator</code> object checks the OCA Bundle for any inconsistencies or errors, such as missing or invalid overlays, and returns information about any issues it finds. It allows users to ensure that the OCA Bundle is valid and can be used for accessing and analyzing the data.</p>

<h2 id="validating-captured-data">Validating Captured Data</h2>

<p>To validate the captured data, you need to use a tool like the <a href="https://oca.colossi.network/ecosystem/oca-validator.html">OCA Data Validator</a>. This tool allows you to check that the data in a CSV file conforms to the structure and format defined in an OCA Bundle.</p>

<p>To use the OCA Data Validator, you first need to <a href="https://data-vault.argo.colossi.network/api/v1/files/E3AP34Xxh9zcAwwuw_zo4ixDCdoVHj3ML4LX5CwwF_8s">download</a> an example data file in CSV format. This file contains multiple rows of data, with each row representing a temperature measurement at a specific timestamp.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>timestamp,temperature
1607005200,22.7
1607005260,22.8
1607005320,22.9
1607005380,22.7
1607005440,22.8
...,...
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Once you have downloaded the data file, you can use the OCA Data Validator to check that the data in the file conforms to the OCA Bundle. To do this, you must create a Validator instance, set the validation constraints, and then run the validation process on the data.</p>

<p>Both the JavaScript and Rust examples below show how to do this. The code creates a Validator instance, sets the validation constraints, and checks that the data in the CSV file conforms to the OCA bundle. If any issues are found, an error will be returned.</p>

<p>JavaScript:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">Validator</span><span class="p">,</span> <span class="nx">CSVDataSet</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">oca-data-validator</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">resolveFromZip</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">oca.js-form-core</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">csv</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">csvtojson</span><span class="dl">'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">oca</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">resolveFromZip</span><span class="p">(</span><span class="nx">ocaBundleFile</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">validator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Validator</span><span class="p">(</span><span class="nx">oca</span><span class="p">)</span>
<span class="nx">validator</span><span class="p">.</span><span class="nx">setConstraints</span><span class="p">({</span> <span class="na">failOnAdditionalAttributes</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>

<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">csv</span><span class="p">().</span><span class="nx">fromFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">path/to/data.csv</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">validator</span><span class="p">.</span><span class="nx">validate</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Rust:</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">oca_conductor</span><span class="p">::{</span>
    <span class="n">Validator</span><span class="p">,</span>
    <span class="nn">validator</span><span class="p">::</span><span class="n">ConstraintsConfig</span><span class="p">,</span>
    <span class="nn">data_set</span><span class="p">::</span><span class="n">CSVDataSet</span>
<span class="p">};</span>
<span class="k">use</span> <span class="nn">oca_zip_resolver</span><span class="p">::</span><span class="n">resolve_from_zip</span><span class="p">;</span>

<span class="k">let</span> <span class="n">oca</span> <span class="o">=</span> <span class="nf">resolve_from_zip</span><span class="p">(</span><span class="s">"path/to/oca_bundle.zip"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="k">mut</span> <span class="n">validator</span> <span class="o">=</span> <span class="nn">Validator</span><span class="p">::</span><span class="nf">new</span><span class="p">(</span><span class="n">oca</span><span class="p">);</span>
<span class="n">validator</span><span class="nf">.set_constraints</span><span class="p">(</span><span class="n">ConstraintsConfig</span> <span class="p">{</span>
    <span class="n">fail_on_additional_attributes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
<span class="p">});</span>

<span class="k">let</span> <span class="n">file_path</span> <span class="o">=</span> <span class="nn">std</span><span class="p">::</span><span class="nn">path</span><span class="p">::</span><span class="nn">Path</span><span class="p">::</span><span class="nf">new</span><span class="p">(</span><span class="s">"path/to/data.csv"</span><span class="p">);</span>
<span class="k">let</span> <span class="n">file_contents</span> <span class="o">=</span> <span class="nn">std</span><span class="p">::</span><span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="n">validator</span><span class="nf">.add_data_set</span><span class="p">(</span>
    <span class="nn">CSVDataSet</span><span class="p">::</span><span class="nf">new</span><span class="p">(</span><span class="n">file_contents</span><span class="nf">.to_string</span><span class="p">())</span>
        <span class="nf">.delimiter</span><span class="p">(</span><span class="sc">','</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">validator</span><span class="nf">.validate</span><span class="p">();</span> <span class="c1">// Result&lt;(), Vec&lt;ValidationError&gt;&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>In the JavaScript code, the <code class="language-plaintext highlighter-rouge">oca-data-validator</code> and <code class="language-plaintext highlighter-rouge">oca.js-form-core</code> packages are used to create a Validator instance and resolve the OCA Bundle. The <code class="language-plaintext highlighter-rouge">csvtojson</code> package is used to parse the CSV file into a JSON object, which is then passed to the <code class="language-plaintext highlighter-rouge">validate</code> method on the <code class="language-plaintext highlighter-rouge">Validator</code> instance to validate the data against the OCA Bundle.</p>

<p>In the Rust code, the <code class="language-plaintext highlighter-rouge">oca_conductor</code> and <code class="language-plaintext highlighter-rouge">oca_zip_resolver</code> crates are used to create a <code class="language-plaintext highlighter-rouge">Validator</code> instance and resolve the OCA Bundle. The <code class="language-plaintext highlighter-rouge">std::fs</code> module reads the CSV file’s contents into a String, which is then passed to the <code class="language-plaintext highlighter-rouge">add_data_set</code> method on the <code class="language-plaintext highlighter-rouge">Validator</code> instance. The <code class="language-plaintext highlighter-rouge">validate</code> method is called on the <code class="language-plaintext highlighter-rouge">Validator</code> instance to validate the data against the OCA Bundle.</p>

<h2 id="transforming-units-converting-from-celsius-to-kelvin">Transforming Units: Converting from Celsius to Kelvin</h2>
<p>Transforming units is a common task when working with data captured by sensors. In the case of temperature data, it may be necessary to convert from one unit of measurement to another. For example, you may need to convert from Celsius to Kelvin or vice versa.</p>

<p>The following code demonstrates how to use the <a href="https://oca.colossi.network/ecosystem/oca-transformer.html">OCA Data Transformer</a> to convert the units of captured data from Celsius to Kelvin.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">Transformer</span><span class="p">,</span> <span class="nx">CSVDataSet</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">oca-data-transformer</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">resolveFromZip</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">oca.js-form-core</span><span class="dl">'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">data.csv</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">delimiter</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">,</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">oca</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">resolveFromZip</span><span class="p">(</span><span class="nx">ocaBundleFile</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">transformer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Transformer</span><span class="p">(</span><span class="nx">oca</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">addDataSet</span><span class="p">(</span><span class="k">new</span> <span class="nx">CSVDataSet</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">delimiter</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">transform</span><span class="p">([</span><span class="s2">`
{
  "attribute_units": {
    "temperature": "K"
  },
  "capture_base": "E1ZVGMTH-A-E4jJ5HDM7Lkpwz822Fs4Sa4HNol7oGY9M",
  "metric_system": "SI",
  "type": "spec/overlays/unit/1.0"
}
  `</span><span class="p">])</span>

<span class="nx">transformer</span><span class="p">.</span><span class="nx">getRawDatasets</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The code reads the data from a CSV file called <code class="language-plaintext highlighter-rouge">data.csv</code> using the <code class="language-plaintext highlighter-rouge">fs</code> module and stores the data in a variable called <code class="language-plaintext highlighter-rouge">data</code>. The code also sets a delimiter for the CSV data, specifying the character used to separate the values in each row. In this case, the delimiter is a comma.</p>

<p>The code then uses the <code class="language-plaintext highlighter-rouge">resolveFromZip</code> function from the <code class="language-plaintext highlighter-rouge">oca.js-form-core</code> package to read the OCA Bundle from the specified zip archive file.</p>

<p>Next, the code creates a new <code class="language-plaintext highlighter-rouge">Transformer</code> instance and adds the <code class="language-plaintext highlighter-rouge">CSVDataSet</code> instance that was created earlier to the transformer. The <code class="language-plaintext highlighter-rouge">Transformer</code> instance is then used to transform the data in the OCA Bundle. In this case, the transformation is specified using a Unit overlay that defines the attribute units to be used for the temperature data (in this case, Kelvin).</p>

<p>Finally, the code calls the <code class="language-plaintext highlighter-rouge">getRawDatasets</code> method on the <code class="language-plaintext highlighter-rouge">Transformer</code> instance to retrieve the transformed data. This method returns the transformed data as an array of datasets, which can be accessed and used as needed.</p>

<h2 id="conclusion-and-next-steps">Conclusion and Next Steps</h2>
<p>The OCA Bundle provides a number of benefits over more traditional methods of representing data. It enables the data from different sensors and devices to be easily combined and shared with other applications or systems, which can help to improve the interoperability and usefulness of the data. Additionally, the OCA Bundle provides a consistent and well-defined structure for representing sensor data, which can make it easier for developers to work with the data in their applications.</p>

<p>There are many ways to continue exploring OCA and working with OCA data. One possible next step is to look at the <a href="https://oca.colossi.network/specification/">OCA specification</a> in more detail and learn more about the different elements of OCA. Another potential direction is to experiment with different ways of accessing and working with OCA data, such as using the <a href="https://www.npmjs.com/package/oca.js">oca.js</a> library, <a href="https://crates.io/crates/oca-rust">oca-rust</a> crate or other <a href="https://oca.colossi.network/ecosystem/tour.html">tools</a> and libraries that support OCA. Finally, you could explore the use of OCA in real-world applications, such as IoT systems or other scenarios where data is collected and shared. Regardless of which direction you choose to take, OCA provides a powerful and flexible framework for managing and working with data.</p>

<h2 id="appendix">Appendix</h2>
<h4 id="oca-object-with-form-and-credential-overlays-ignored">OCA object (with Form and Credential overlays ignored):</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"capture_base"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"temperature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Numeric"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Text"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"classification"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"digest"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EmL-JD22a1RywPXzzZLAEOxR8NHSi-04pQnOhNwHG7sg"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"flagged_attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spec/capture_base/1.0"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"overlays"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attribute_character_encoding"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"temperature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"utf-8"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"utf-8"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"capture_base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EmL-JD22a1RywPXzzZLAEOxR8NHSi-04pQnOhNwHG7sg"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"default_character_encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"utf-8"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"digest"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EmYQZgAnoE_AIsOiZHL17jw7KGnYgY1pPRFfSUnVYUj0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spec/overlays/character_encoding/1.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attribute_units"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"temperature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"capture_base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EmL-JD22a1RywPXzzZLAEOxR8NHSi-04pQnOhNwHG7sg"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"digest"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EATuKGoJosYKLyLvdNBXpFM2YeuKuzvthOHu08whWWmA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"metric_system"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nonSI"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spec/overlays/unit/1.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>


  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2022/11/21/mobile-app-content-accessibility/">
        Mobile app content accessibility
      </a>
    </h1>

    <time datetime="2022-11-21T17:27:05+00:00" class="post-date">21 Nov 2022</time>
    
    <p class="post-author">
    by
    
    Justyna Gręda
    
    </p>
    

    <p>Nowadays, with the growth of technology and its usage in society, more and more stuff can be done with a tap on the screen. Shopping, ordering food, even taking a loan, all this is possible without leaving the home. Moreover, it’s a technological goal to make everyday situations done within a short period of time when simply sitting on a couch. However, when for most of the people can more or less easily access such an app, it is important to make it reachable to the group of people with disabilities.</p>
<h2 id="w3c-guide">W3C guide</h2>
<p>In its <a href="https://www.w3.org/TR/mobile-accessibility-mapping/">main document about mobile accessibility</a> , W3C points out that mobile doesn’t only mean phones - other wearable and portable devices count here as well. But let us focus on the apps designed for what we always keep in our pockets. The organization has chosen four principles, that mobile applications designed to be approachable for the disabled should follow:</p>
<ul>
  <li><strong>Perceivance -</strong> Becoming aware of users’ incapacities, this part of the documents speaks of the screen size, zoom and contrast</li>
  <li><strong>Operability -</strong> Making the app work similarly well to the non-accessible version, this principle speaks about moving around the app with multiple gestures and screen control.</li>
  <li><strong>Understandability -</strong> When making an app easier to access, it is also important to make it as easy to use, as possible. This section mentions the consistency of application layout.</li>
  <li><strong>Robustness -</strong> Preparing an app for all the “damage” that can be done with e.g. inputs, this area of the document acknowledges ways of entering the data to the application.</li>
</ul>

<p>Let us focus on each principle and present recomendations suggested by W3C for designing an mobile app.</p>

<h3 id="perceivance">Perceivance</h3>
<ul>
  <li>Small screen limits the amount of information that can be shown to the user. It is important to minimize it in comparison with the desktop version. Focus on the most important ones.</li>
  <li>When the amount of information has to stay the same, provide different rendering to make it as readable and accessible, as possible.</li>
  <li>Decrease the need for zooming in.</li>
  <li>When it comes to data forms, position the form fields below their labels</li>
</ul>

<p><img src="/static/img/20221121/iHRzjxf.png" alt="" /></p>

<ul>
  <li>User should be available to control app content size. OS-level features to handle it include setting defaut text size (in Display Settings), or magnifying entire screen/part of the screen under user’s fingers (available in Accessibility Settings)</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/resize-text"><strong>Success Criterion 1.4.4 Resize Text (Level AA):</strong></a> Except for captions and images of text, text can be resized without assistive technology up to 200 percent without loss of content or functionality.</li>
  <li>It should be kept in mind that mobile phones can be used in different outdoor conditions and the readability of screen content may vary.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum"><strong>Success Criterion 1.4.3 Contrast (Minimum) (Level AA):</strong></a>  The visual presentation of text and images of text has a contrast ratio of at least 4.5:1. In practice, it means that the difference in color between text and its background should be big enough for the text to be accessible for by people with moderately low vision (who do not use contrast-enhancing assistive technology).
<strong>Contrast of 1.45:1 :</strong>
<img src="/static/img/20221121/HHr2Iii.png" alt="" />
<strong>Contrast of 4.84:1 :</strong>
<img src="/static/img/20221121/OGLhcWe.png" alt="" /></li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/contrast-enhanced"><strong>Success Criterion 1.4.6 Contrast (Enhanced) (Level AAA):</strong></a> The visual presentation of text and images of text has a contrast ratio of at least 7:1
<strong>Contrast of 8.3:1 :</strong>
<img src="/static/img/20221121/7FKkbTo.png" alt="" /></li>
</ul>

<h3 id="operability">Operability</h3>
<ul>
  <li>The advantage of mobile phones is that the keyboard, not being physical, is only visible when focused on some input. It is important to make it as accessible as possible, including a support for an external physical keyboard or alternative input ways.</li>
  <li>People with visual disabilities can benefit from some characteristics of physical keyboards over touchscreen keyboards</li>
  <li>People with physical disabilities, can benefit from keyboards optimized to minimize inadvertent presses</li>
  <li>Some people can be confused by the dynamic nature of the digital keyboard and may prefer the physical one.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/keyboard.html"><strong>Success Criterion 2.1.1 Keyboard (Level A):</strong></a> All functionality of the content is operable through a keyboard interface without requiring specific timings for individual keystrokes, except where the underlying function requires input that depends on the path of the user’s movement and not just the endpoints. This means the keyboard interface is being used and the usage of alternate keyboard is possible. E.g. a blind person is not able to use the mouse input, or any other one that requires mouse-hand coordination.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/no-keyboard-trap"><strong>Success Criterion 2.1.2 No Keyboard Trap (Level A):</strong></a> If keyboard focus can be moved to a component of the page using a keyboard interface, then focus can be moved away from that component using only a keyboard interface, and, if it requires more than unmodified arrow or tab keys or other standard exit methods, the user is advised of the method for moving focus away. E.g. user can move through the calendar tabbing through its content.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/focus-order"><strong>Success Criterion 2.4.3 Focus Order (Level A):</strong></a> If a Web page can be navigated sequentially and the navigation sequences affect meaning or operation, focusable components receive focus in an order that preserves meaning and operability. This means order of the sequential information should be consistent with with focus order.</li>
  <li>
    <p><a href="https://www.w3.org/WAI/WCAG21/Understanding/focus-visible"><strong>Success Criterion 2.4.7 Focus Visible (Level AA):</strong></a> Any keyboard operable user interface has a mode of operation where the keyboard focus indicator is visible. The app developer should help the user know which element has the keyboard focus. ‘
<img src="/static/img/20221121/NIAxAx3.png" alt="" /></p>
  </li>
  <li>
    <p>Interactive elements on the screen should be big enough and spaced widely enough not to be tapped by accident when wanting to perform other action. Best practices recommend ensuring that touch targets are at least 9 mm high by 9 mm wide (which is around 48x48dp) and surrounded by a small amount of inactive space.
<img src="/static/img/20221121/BsFgFlL.png" alt="" /></p>
  </li>
  <li>In the age of multiple screen gestures, it important to make them as simple as possible. For people with some disabilities who e.g. use a stylus, some gestures might be hard to perform. Another thing is that some instructions on how to use provided gestures can be useful.</li>
  <li>Be careful of device manipulation gestures - when shaking or tilting the phone may not be a hard action to perform, it can be a challenge for users with disabilities.</li>
  <li>Buttons should be easily accessible, e.g. with a move of thumb, no matter left or right hand.</li>
</ul>

<h3 id="understandability">Understandability</h3>
<ul>
  <li>Some users have their devices fixed in a particular position, e.g. when mounted to a wheelchair. Developers should try to support both portrait and landscape orientation of an app. Moreover, changes in orientation should be signalled if the user is utilizing the screen reader.</li>
  <li>Consistency of layout is essential. If an element is repeated throughout a screens, its position should be fixed and the same on all of them. Order of reappearing elements should also be equal.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/consistent-navigation"><strong>Success Criterion 3.2.3 Consistent Navigation (Level AA):</strong></a> Navigational mechanisms that are repeated on multiple Web pages within a set of Web pages occur in the same relative order each time they are repeated, unless a change is initiated by the user. E.g. Iindividuals with low vision who use screen magnification to display a small portion of the screen at a time often use visual cues and page boundaries to quickly locate repeated content.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/consistent-identification"><strong>Success Criterion 3.2.4 Consistent Identification (Level AA):</strong></a> Components that have the same functionality within a set of Web pages are identified consistently. People who use screen readers use when operating a rely heavily on their familiarity with functions that may appear on different Web pages. If identical functions have different labels (or, more generally, a different accessible name) on different Web pages, the site will be considerably more difficult to use.</li>
  <li>Most important piece of information should be visible without scrolling</li>
  <li>Elements that perform the same actions should not be duplicated.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/link-purpose-in-context"><strong>Success Criterion 2.4.4 Link Purpose (In Context) (Level A):</strong></a> The purpose of each link can be determined from the link text alone or from the link text together with its programmatically determined link context, except where the purpose of the link would be ambiguous to users in general.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/link-purpose-link-only"><strong>Success Criterion 2.4.9 Link Purpose (Link Only) (Level AAA):</strong></a> A mechanism is available to allow the purpose of each link to be identified from link text alone, except where the purpose of the link would be ambiguous to users in general.</li>
  <li>Elements that trigger changes should be easily distinguishable from non-actionable elements. They should also be recognizable by screen readers. Examples of distinguishing features include providing a conventional shape, style or positioning, color offset and widely known iconography.</li>
  <li><a href="https://"><strong>Success Criterion 3.3.2 Labels or Instructions (Level A):</strong></a> Labels or instructions are provided when content requires user input. It helps to ensure the user will understand how to access the input and what to in there.</li>
  <li><a href="https://www.w3.org/WAI/WCAG21/Understanding/help"><strong>Success Criterion 3.3.5 Help (Level AAA):</strong></a> Context-sensitive help is available. Users with disabilities may be more likely to make mistakes than users without disabilities. Using context-sensitive help, users find out how to perform an operation without losing track of what they are doing.</li>
</ul>

<h3 id="robustness">Robustness</h3>
<ul>
  <li>Setting the type of keyboard helps prevent errors and ensures formats are correct. However, it can be confusing for people who are using a screen reader when there are subtle changes in the keyboard.</li>
  <li>The need for text entry should be reduced. Provide select menus, radio buttons, check boxes or by automatically entering known information (e.g. date, time, location).</li>
  <li>Support the platform characteristic features defined in accessibility settings.</li>
</ul>

<h2 id="accessibility-in-practice">Accessibility in practice</h2>
<ul>
  <li><strong>Accessibility settings -</strong> Main place for all accessibility features available on both Android and iOS. It allows for control of visual, auditory and motor aids on the device.</li>
</ul>

<div style="text-align: center;">
  <img src="/static/img/20221121/1qJrIKj.gif" width="300" style="display: inline;" />
  <img src="/static/img/20221121/z2N4yhA.gif" width="300" style="display: inline;" />
</div>

<p>As it has been mentioned by W3C, the text size and contrast remain a very important criterium when developing an accessible app. From the accessibility settings, user can select larger text size, enhance the contrast or even choose a color-corrected display for partial color blindness. However, it only affects the visible colors, not the real colors and the change is not visible on a screenshot.</p>

<ul>
  <li><strong>Screen reader -</strong> One of the most important features for people with impaired vision. It reads the content of the screen to the user and is available from the phone’s accessibility settings, no need for downloading an app. It goes under a name TalkBack on Android and VoiceOver on iOS.</li>
</ul>

<div style="text-align: center;">
  <img src="/static/img/20221121/m1bJue4.png" width="300" style="display: inline;" />
  <img src="/static/img/20221121/w9go2Ys.png" width="300" style="display: inline;" />
</div>

<p>TalkBack/VoiceOver proves the importance of good input fields labelling, decreasing the amount of information on one screen and intuitive layout. With such proper sign, the operation of screen reader is more simplified.
The screen reader settings also allow the user to configure a Braille keyboard. But what does it look like, if the widely known Braille focuses on touch? Well, the Braille keyboard on mobile takes entire screen and shows six dots which, with some help of the screen reader allow for the input.</p>

<div style="text-align: center;">
  <img src="/static/img/20221121/iU084pG.png" width="71%" style="display: inline;" />
</div>

<p><a href="https://www.youtube.com/watch?v=2AdRFFkE9cI&amp;ab_channel=gallagher123123">Here</a> is a video on how the TalkBack screen reader is used as well as the Braille input.</p>

<ul>
  <li><strong>Switch access -</strong> It allows for the device to be controlled by a physical switch. Provides a way of input and phone handling for people with motion impairement. Available natively on both Android and iOS under the accessibility settings.</li>
</ul>

<div style="text-align: center;">
  <img src="/static/img/20221121/8FPQJxb.png" width="300" style="display: inline;" />
  <img src="/static/img/20221121/NrwRorH.png" width="300" style="display: inline;" />
</div>

<p>This feature exploits the understandability criterium, recommend by W3C. Switch access might be used by people with serious enough mobility issues to be put on a wheelchair, where the phone would be in a fixed position and orientation. Moreover, if the app layout repeats on a few screens, a person using a switch will be able to move around the app much faster.
Below is an official Google video showing a short explanation of switch access feature. For more tutorials visit <a href="https://support.google.com/accessibility/android/answer/6122836?hl=en">Google support page</a>.</p>

<div align="center">
      <a href="https://www.youtube.com/watch?v=rAIXE6ilRQ0">
         <img src="https://img.youtube.com/vi/rAIXE6ilRQ0/0.jpg" style="width:70%;" />
      </a>
</div>

<h2 id="flutter-and-encoded-accessibility">Flutter and “encoded” accessibility</h2>
<p>Another important concept is whether it is possible to somehow encode a desire for accessibility in an app. When the user interface of an app is divided into template and layout overlays, first of them containing widgets arrangement while the other one the widgets themselves with their args, the question is, is it achievable to impose on them both third, accessibility overlay? Let us present a few possible solutions considering flutter as a app programming language.</p>

<ul>
  <li><strong>Acessibility overlay idea #1</strong> - For some requirements it would be possible to inject them into the widget tree combining not two but THREE overlays. Considering using <a href="https://pub.dev/packages/json_dynamic_widget">json_dynamic_widget</a> as a widget tree builder and some own code for merging two JSONs into package-readable one, the third JSON aka accessibility overlay would have to be injected into layout overlay JSON. Let us consider some particular requirements:
    <ul>
      <li>
        <p>Label positioning - This one is possible to impose, with some constraints. What is not known from the TextFormField widget and its arguments itself is whether the developer has put the field in a column/row with a text description, <em>fake label</em>. Below is an example of a JSON describing a text_form_field.</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text_form_field"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"decoration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"hintText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"labelText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"First Name"</span><span class="p">,</span><span class="w">
    </span><span class="p">},</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>If a developer has put a <code class="language-plaintext highlighter-rouge">hintText</code> there, but no <code class="language-plaintext highlighter-rouge">labelText</code>, code that merges the overlays could put <code class="language-plaintext highlighter-rouge">hintText</code> value for a <code class="language-plaintext highlighter-rouge">labelText</code>. Not a perfect solution, since label should be a definite word describing input, while hint should be providing an example for an input, but when a hintText says <code class="language-plaintext highlighter-rouge">Your name, e.g. John</code>, such label text would be enough to understand. If a developer has put a fake label above a TextFormField, that would be more difficult, but the merger could check for a widget “next to” the TextFormField. ONLY if they remain in the same row/column. But what if they do not?</p>
      </li>
      <li>keyboard type - robustness criterium to provide e.g. numeric keyboard when a PIN input is wanted. Again, having in mind a Flutter <code class="language-plaintext highlighter-rouge">TextFormField</code> widget, it can define a keyboard type using <code class="language-plaintext highlighter-rouge">keyboardType</code> attribute:
        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text_form_field"</span><span class="err">,</span><span class="w">
</span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first_name"</span><span class="err">,</span><span class="w">
</span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"keyboardType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phone"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>Easy to inject as well. Merging code could easily impose a <code class="language-plaintext highlighter-rouge">keyboardType</code> arg if it has not been provided. BUT what kind of keyboard type? Accessibility recommendation is that a specific input is provided for some fields like phone number. No doubts about that, for people using switch access it would be much faster to switch through 9 numbers that wait for the right number on the qwerty keyboard to show. The proposal is to provide it. However, the input type depends on the form data themselves. It is not possible to do something like this for accessibility overlay:</p>
        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nl">"accessibility"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text_form_field"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"keyboardType"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>This way, what can be achieved is a necessity to provide a keyboard type. But the type itself would have to be read e.g. from a label - if it says ‘phone’, go for <code class="language-plaintext highlighter-rouge">"keyboardType" : "phone"</code>. ‘email address’? <code class="language-plaintext highlighter-rouge">"keyboardType" : "emailAddress"</code>. But what if the label says something completely different, like PESEL evidential number? Merging code would have to be programmed to read this as a numeric input. Moreover, it is not possible to just copy the label as a keyboard type. Email being a great example for this one.</p>
      </li>
      <li>Link purpose - Is it even possible to define this one? The AAA criterium says that every link text should define link purpose. Considering such a situation - the developer is making an app about birds. Each screen is a name, photo and short description of a bird. App is accessible, contrast is 8.5:1, font is large. At the bottom of each screen there is a smaller <code class="language-plaintext highlighter-rouge">Source of information</code> text, which serves as a link to a Wikipedia page about each bird. And this is perfectly fine, screen reader would read this as “Source of information. Double tap to activate” or something similar, the user would know how to follow it. But is it achievable to enforce a understandable link text? Let us start with the fact that it is UNKNOWN whether a text is a link - Flutter has no link widget, and a simple way to provide a link text would look like <a href="https://stackoverflow.com/questions/43583411/how-to-create-a-hyperlink-in-flutter-widget">this</a> (<code class="language-plaintext highlighter-rouge">url_launcher</code> package required):
        <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">InkWell</span><span class="o">(</span>
  <span class="nl">child:</span> <span class="n">Text</span><span class="o">(</span><span class="s">'Open Browser'</span><span class="o">),</span>
  <span class="nl">onTap:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="n">launch</span><span class="o">(</span><span class="s">'https://docs.flutter.io/flutter/services/UrlLauncher-class.html'</span><span class="o">)</span>
  <span class="o">),</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>It is not desirable to impose something on each <code class="language-plaintext highlighter-rouge">InkWell</code> widget as none of them have to be links. But hypothetically, considering there exists a link widget, how can it be forced to say “Source of information” instead of e.g. “x”? Only when it is known that the screen is responsible of information about birds and if a link occurs, it is a source of information on Wikipedia. Such hypothetical accessibility overlay could look like this:</p>
        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nl">"accessibility"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link_widget"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Source of information"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
      <li>Focus visible - a criterium that actually could be imposed by an accessibility layout. Not in the best possible way, hovever. This one mentions that a focused field (let us talk about a <code class="language-plaintext highlighter-rouge">TextFormField</code> again…) should be easily distinguished from a non-focused one. Luckily, <code class="language-plaintext highlighter-rouge">TextFormField</code>’s <code class="language-plaintext highlighter-rouge">InputDecoration</code> has a field called <code class="language-plaintext highlighter-rouge">focusedBorder</code>, which defines a border, that is shown when the field is focused. Accessiblity overlay could force that a border width, when the field is not fucused would be 1 and when focused, 3. It would enable the user to distinguish between the states of the text field:
        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="nl">"accessibility"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text_form_field"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"decoration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"focusedBorder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"outline"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"args"</span><span class="p">:{</span><span class="w">
                        </span><span class="nl">"borderSide"</span><span class="p">:{</span><span class="w">
                            </span><span class="nl">"width"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"border"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"outline"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"args"</span><span class="p">:{</span><span class="w">
                        </span><span class="nl">"borderSide"</span><span class="p">:{</span><span class="w">
                            </span><span class="nl">"width"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>

    <p>This way color of none of the borders would be defined, but the difference between focused and unfocused state would be imposed.</p>

    <ul>
      <li>Interactive elements size - Luckily, when it comes to buttons (but buttons only!) Flutter provides a way to define their size. Each of the button classes (<code class="language-plaintext highlighter-rouge">ElevatedButton</code>, <code class="language-plaintext highlighter-rouge">OutlinedButton</code>, <code class="language-plaintext highlighter-rouge">TextButton</code>) has an attribute called <code class="language-plaintext highlighter-rouge">minimumSize</code>:
        <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">ElevatedButton</span><span class="o">(</span>
    <span class="nl">onPressed:</span> <span class="n">onPressed</span><span class="o">,</span> 
    <span class="nl">child:</span> <span class="kd">const</span> <span class="n">Text</span><span class="o">(</span><span class="s">'x'</span><span class="o">),</span>
    <span class="nl">style:</span> <span class="n">ElevatedButton</span><span class="o">.</span><span class="na">styleFrom</span><span class="o">(</span>
      <span class="nl">minimumSize:</span> <span class="n">Size</span><span class="o">(</span><span class="mi">48</span><span class="o">,</span> <span class="mi">48</span><span class="o">),</span>
    <span class="o">),</span>
  <span class="o">),</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>This way, an accessibility overlay can enforce a minimum size of a button:</p>
        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nl">"accessibility"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elevated_button"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"style"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"minimumSize"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">48</span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>However it is crucial to keep in mind that buttons are not the only elements that are interactive.</p>
      </li>
    </ul>
  </li>
</ul>

<p>Accessibility overlay would for sure be a step forward, but there are situations where automatic imposing of some accessibility recommendations would not be possible and human verification would be crucial.</p>

<ul>
  <li><strong>Overlay parser -</strong> Not a overlay itself, this last chance solution would be checking whether the designed layout meets accessibility requirements, not imposing them.  This should be treated as a “fun fact” and a workaround, not a definite solution.
    <ul>
      <li>Color contrast - What is necessary to find the contrast between two colored items is the tint of both child and parent widget, for entire widget. While not impossible, it would impose a requirement of iterating through all widgets and developing some contrast checking code.
        <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">for</span><span class="o">(</span><span class="n">widget</span> <span class="k">in</span> <span class="n">widgetTree</span><span class="o">){</span>
    <span class="kd">var</span> <span class="n">contrast</span> <span class="o">=</span> <span class="n">checkContrast</span><span class="o">(</span><span class="n">widget</span><span class="o">.</span><span class="na">parent</span><span class="o">,</span> <span class="n">widget</span><span class="o">)</span>
    <span class="k">if</span><span class="o">(</span><span class="n">contrast</span><span class="o">&gt;</span> <span class="mi">7</span><span class="o">:</span><span class="mi">1</span><span class="o">){</span>
        <span class="c1">//App very accessible</span>
    <span class="o">}</span><span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">contrast</span><span class="o">&gt;</span> <span class="mf">4.5</span><span class="o">:</span><span class="mi">1</span><span class="o">){</span>
        <span class="c1">//App accessible</span>
    <span class="o">}</span><span class="k">else</span><span class="o">{</span>
        <span class="c1">//App not accessible</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
      <li>Label positioning - Label of a TextFormField should be positioned above the field, not next to it. Actually, there is no need of an artificial label at all. TextFormField has a field called <code class="language-plaintext highlighter-rouge">decoration</code> which can contain the label itself:
        <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">TextFormField</span><span class="o">(</span>
  <span class="nl">decoration:</span> <span class="kd">const</span> <span class="n">InputDecoration</span><span class="o">(</span>
    <span class="nl">icon:</span> <span class="n">Icon</span><span class="o">(</span><span class="n">Icons</span><span class="o">.</span><span class="na">person</span><span class="o">),</span>
    <span class="nl">hintText:</span> <span class="s">'What do people call you?'</span><span class="o">,</span>
    <span class="nl">labelText:</span> <span class="s">'Name'</span><span class="o">,</span>
  <span class="o">),</span>
<span class="o">)</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>So it would be necessary to just check whether all the widget tree elements that are of type TextFormField contain labelText.</p>
        <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">for</span><span class="o">(</span><span class="n">widget</span> <span class="k">in</span> <span class="n">widgetTree</span><span class="o">){</span>
    <span class="k">if</span><span class="o">(</span><span class="n">widget</span><span class="o">.</span><span class="na">isTextFormField</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">widget</span><span class="o">.</span><span class="na">containsLabelText</span><span class="o">){</span>
            <span class="c1">//App accessible</span>
        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
            <span class="n">App</span> <span class="n">not</span> <span class="n">accessible</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
        <p>And the list can go on and on. Let us stop with these 2 examples as this idea is just a workaround, not a real solution.</p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="accessibility-overlay-proposal">Accessibility overlay proposal</h2>
<p>Summing up the points about encoded accessibility and W3C guide, the JSON shown in this part of the article could serve as an accessibility overlay. It is important to keep in mind that many of the requirements proposed by W3C cannot be machine-imposed. A lot of them require some context to be understood, like link text or keyboard type.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="nl">"accessibility"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elevated_button"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"style"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"minimumSize"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">48</span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text_form_field"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"decoration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"focusedBorder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"outline"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"args"</span><span class="p">:{</span><span class="w">
                        </span><span class="nl">"borderSide"</span><span class="p">:{</span><span class="w">
                            </span><span class="nl">"width"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"border"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"outline"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"args"</span><span class="p">:{</span><span class="w">
                        </span><span class="nl">"borderSide"</span><span class="p">:{</span><span class="w">
                            </span><span class="nl">"width"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="summary">Summary</h2>
<p>Accessibility overlay could serve an important purpose for both disabled people and app developers. Without further research, app creators would be able to adjust their content to some special needs. No matter how easy this sounds, the real task is actually much more difficult. First of all, the list created by W3C is just a requirement guide. Actual people with disabilities may have other, individual wishes, that are not on the list. Such briefs or proposed here solutions are made by people who do not use them. It would be advised to consult accessibility solutions with people who would be their users, who need the app adjusted to their needs. Moreover, as stated before, some of the solutions for accessibility overlay require context of the field. Keyboard type or link text has to be imposed basing on their surroundings, which may be hard or even impossible to get by a machine. Another important thing is the operating system of a device. Actually it is absolutely stunning that both mobile ecosystems have so many native solutions for accessibility, that allow numerous disabled people to use their products with greater comfort (or even be able to use them at all). However, for desktops, the accessibility features may look completely different. Overlays should be able to distinct between mobile and stationary device, which requires at least two accessibility overlays for one app. To sum up, it would be both beneficial and really hard to create a solution that would successfully impose amenities for the disabled on the app creation.</p>

<h2 id="references">References</h2>
<p>Picture references: <a href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fdisabilityinsider.com%2F2020%2F04%2F10%2Ftechnology%2Fgoogle-introduces-new-braille-keyboard-for-android%2F&amp;psig=AOvVaw1uzDMSVyR6fXwkBVJyyc2G&amp;ust=1666432368107000&amp;source=images&amp;cd=vfe&amp;ved=0CA0QjRxqFwoTCIDV2dGG8foCFQAAAAAdAAAAABAN">1</a>, <a href="https://www.pngegg.com/en/png-dkhhk">2</a>, <a href="https://www.pngegg.com/en/png-bzpfz">3</a></p>

<p><a href="https://webaim.org/resources/contrastchecker/">Contrast checking website</a></p>

<p><a href="https://api.flutter.dev/flutter/material/TextFormField-class.html">Label positioning example</a></p>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2022/09/26/flutter-and-rust-combined-creating-a-plugin-to-support-various-operating-systems/">
        Flutter and Rust combined. Creating a plugin to support various operating systems
      </a>
    </h1>

    <time datetime="2022-09-26T17:27:05+00:00" class="post-date">26 Sep 2022</time>
    
    <p class="post-author">
    by
    
    Justyna Gręda
    
    </p>
    

    <p>Both, Flutter and Rust are pretty novel technologies in the industry. Both also introduce a paradigm shift of how to approach portability, a very old and diffcult problem to solve. Portability is diffcult due to lack of common denominator across platforms, devices and operating systems. To achieve it, Flutter comes with a concept of <a href="https://docs.flutter.dev/development/platform-integration/platform-channels">MethodChannel</a>, a cross-boundary interface that allows to write and call platform native code. It then enables seamless integrations that are essential when working with Operating System specific user interface or natively accessing device peripherals. No more tweaks thanks to proper integration mechanisms. Rust, on the the other hand, is getting traction in various ecosystems and there are at least several reasons why it becomes more and more popular as general purpose programming language. Rust is in essence a C-based language with novel concepts and modern tooling supporting the language. It has steep learning curve due to the architectural decisions baked in into the language. However once it is overcame it pays off. One especially interesing characteristic of the language is its adaptability in almost any environment. As a C-based language, program written in Rust can be exposed as a binary to many modern Operating Systems. Not only that, thanks to <a href="https://en.wikipedia.org/wiki/Foreign_function_interface">Foreign Function Interface (FFI)</a> integration possibilities of Rust-based code, it became viable alternative to write platform agnostic code and expose it through FFI. In other words one Rust library can be consumed by any other C-based language. The core business logic is then encapsulated into one library that is later consumed within platform specific languages.</p>

<p>This post guides the reader how to benefit from Flutter and Rust collaboration in a best form. When native programming lanugages available in <code class="language-plaintext highlighter-rouge">FlutterMethodChannel</code> don’t come in handy, <a href="https://pub.dev/packages/flutter_rust_bridge">flutter_rust_bridge</a> might be the solution. It allows the use of Rust code in Flutter application through an externally generated library. This tutorial however will not be introducing to the usage of the plugin. It assumes the user is familiar with <code class="language-plaintext highlighter-rouge">flutter_rust_bridge</code> <a href="http://cjycode.com/flutter_rust_bridge/">documentation</a> and knows the basics. Moreover, to build for iOS and MacOS it is necessary to have access to Xcode and MacOS device. To build for Windows, Windows OS is needed as well. <code class="language-plaintext highlighter-rouge">flutter_rust_bridge</code> provided tutorial for Android + Rust plugin so it will not be covered here.</p>

<p>A proof of concept plugin can be found <a href="https://github.com/argonAUTHs/flutter_rust_plugin">here</a>.</p>

<h2 id="initial-steps">Initial steps</h2>
<ol>
  <li>In the root folder of your project create a new directory. It will be later referred here as <code class="language-plaintext highlighter-rouge">$rust_part</code>.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">cargo init</code> inside <code class="language-plaintext highlighter-rouge">$rust_part</code>. This will create <code class="language-plaintext highlighter-rouge">src</code> folder and <code class="language-plaintext highlighter-rouge">Cargo.toml</code> file.</li>
  <li>In the <code class="language-plaintext highlighter-rouge">src</code> folder there is one file: <code class="language-plaintext highlighter-rouge">main.rs</code>. It can be deleted. Create 2 new files called <code class="language-plaintext highlighter-rouge">lib.rs</code> and <code class="language-plaintext highlighter-rouge">api.rs</code>. The first one will call all modules from rust project while the other is a module containing all functions that should be bridged to dart.</li>
  <li>Modify the <code class="language-plaintext highlighter-rouge">api.rs</code> file and add your library functionality. In this case it will be a simple hello world string function:
    <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre> <span class="k">pub</span> <span class="k">fn</span> <span class="nf">hello</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
     <span class="k">return</span> <span class="s">"Hello World!"</span><span class="nf">.to_string</span><span class="p">();</span>
 <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Modify the <code class="language-plaintext highlighter-rouge">lib.rs</code> file:
    <pre><code class="language-rust=">pub mod api;
</code></pre>
  </li>
  <li>Add the following lines to <code class="language-plaintext highlighter-rouge">Cargo.toml</code> (Notice: The lib lines may change depending on the platform you are building for. ):
    <div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre> <span class="nn">[lib]</span>
 <span class="py">crate-type</span> <span class="p">=</span> <span class="p">[</span><span class="s">"staticlib"</span><span class="p">,</span> <span class="s">"cdylib"</span><span class="p">]</span>

 <span class="nn">[dependencies]</span>
 <span class="py">flutter_rust_bridge</span> <span class="p">=</span> <span class="s">"1"</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Run the following commands in <code class="language-plaintext highlighter-rouge">$rust_part</code>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre> cargo <span class="nb">install </span>flutter_rust_bridge_codegen
 flutter pub add <span class="nt">--dev</span> ffigen
 flutter pub add ffi
 flutter pub add flutter_rust_bridge
 cargo <span class="nb">install </span>cargo-xcode
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Cross compiling targets setup will not be covered here. For more information on the topic please check the recommended <code class="language-plaintext highlighter-rouge">flutter_rust_bridge</code> documentation (<a href="http://cjycode.com/flutter_rust_bridge/template/setup_android.html">here</a> is an example of Android target setup).</li>
  <li>The Rust part is ready to be built. For different targets use:
    <ul>
      <li>For Android: <code class="language-plaintext highlighter-rouge">cargo ndk -o ../android/src/main/jniLibs build --release</code>. This command results in two <code class="language-plaintext highlighter-rouge">librust_part.so</code> files for two Android architectures.</li>
      <li>For Windows: <code class="language-plaintext highlighter-rouge">cargo build --release</code> (has to be executed on Windows OS) . <strong>Important:</strong> The <code class="language-plaintext highlighter-rouge">crate-type</code> in <code class="language-plaintext highlighter-rouge">Cargo.toml</code> has to be changed to <code class="language-plaintext highlighter-rouge">"dylib"</code>. In folder <code class="language-plaintext highlighter-rouge">rust_part/target/release</code> you will find files called <code class="language-plaintext highlighter-rouge">rust_part.dll</code> and <code class="language-plaintext highlighter-rouge">rust_part.dll.lib</code>. Remove the <code class="language-plaintext highlighter-rouge">.dll</code> part from the second one and the Windows files are ready.</li>
      <li>For iOS: <code class="language-plaintext highlighter-rouge">cargo lipo</code>. In folder <code class="language-plaintext highlighter-rouge">rust_part/target/universal/release</code> you will find <code class="language-plaintext highlighter-rouge">librust_part.a</code> file.</li>
      <li>For MacOS: <code class="language-plaintext highlighter-rouge">cargo build --release</code> (has to be executed on Windows OS) . <strong>Important:</strong> The <code class="language-plaintext highlighter-rouge">crate-type</code> in <code class="language-plaintext highlighter-rouge">Cargo.toml</code> has to be changed to <code class="language-plaintext highlighter-rouge">"dylib"</code>. In folder <code class="language-plaintext highlighter-rouge">rust_part/target/release</code> you will find file called <code class="language-plaintext highlighter-rouge">librust_part.dylib</code>.</li>
    </ul>
  </li>
</ol>

<h2 id="ios">iOS</h2>

<ol>
  <li>Make sure you created support for iOS in your project with <code class="language-plaintext highlighter-rouge">flutter create --platform=ios .</code>
<strong>Warning:</strong> This command will create all files that are automatically created when making new Flutter project. If for some reason you deleted some of them, you might need to get rid of them again.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">cargo xcode</code> in <code class="language-plaintext highlighter-rouge">$rust_part</code>. This will create a <code class="language-plaintext highlighter-rouge">.xcodeproj</code> file. This file will be soon opened in Xcode to change symbol stripping method.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">cargo lipo</code> in <code class="language-plaintext highlighter-rouge">$rust_part</code>. To specify target, run with <code class="language-plaintext highlighter-rouge">-p $target</code> flag. To build a release library (smaller in size), use <code class="language-plaintext highlighter-rouge">--release</code> flag.</li>
  <li>Next, run the generator: <code class="language-plaintext highlighter-rouge">flutter_rust_bridge_codegen --rust-input $rust_part/src/api.rs --dart-output lib/bridge_generated.dart --c-output ios/bridge_generated.h</code>
Actually, the location of <code class="language-plaintext highlighter-rouge">bridge_generated.h</code> is not that important, as it is created only to have its content appended to another file.</li>
  <li>Then create a symbolic link in iOS folder to <code class="language-plaintext highlighter-rouge">.a</code> library: <code class="language-plaintext highlighter-rouge">ln -s ../$rust_part/target/universal/release/librust_part.a</code>
You may also move the <code class="language-plaintext highlighter-rouge">.a</code> file to the <code class="language-plaintext highlighter-rouge">ios</code> folder, this way there is no need for the symlink as the library is directly accessible.</li>
  <li>Then append the contents of <code class="language-plaintext highlighter-rouge">bridge_generated.h</code> to <code class="language-plaintext highlighter-rouge">/ios/Classes/$Plugin.h</code>: <code class="language-plaintext highlighter-rouge">cat ios/bridge_generated.h &gt;&gt; ios/Classes/$Plugin.h</code></li>
  <li>Then add in <code class="language-plaintext highlighter-rouge">ios/Classes/.swift</code> file dummy method:
    <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">func</span> <span class="nf">dummyMethodToEnforceBundling</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">// This will never be executed</span>
   <span class="nf">dummy_method_to_enforce_bundling</span><span class="p">();</span>
 <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Next, edit <code class="language-plaintext highlighter-rouge">podspec</code> file and add the following lines:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  s.public_header_files = 'Classes**/*.h'
  s.static_framework = true
  s.vendored_libraries = "**/*.a"
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Next, remember to set the strip style to non global symbols on both the <code class="language-plaintext highlighter-rouge">.xcodeproj</code> in <code class="language-plaintext highlighter-rouge">$rust_part</code> and <code class="language-plaintext highlighter-rouge">.xcodeworkspace</code> in example (if you want to run the example).</li>
  <li>Remember to edit <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> file so it has following structure:
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="na">plugin</span><span class="pi">:</span>
    <span class="na">platforms</span><span class="pi">:</span>
      <span class="na">android</span><span class="pi">:</span>
        <span class="na">package</span><span class="pi">:</span> <span class="s">com.example.flutter_rust_plugin</span>
        <span class="na">pluginClass</span><span class="pi">:</span> <span class="s">FlutterRustPlugin</span>
      <span class="na">ios</span><span class="pi">:</span>
        <span class="na">pluginClass</span><span class="pi">:</span> <span class="s">FlutterRustPlugin</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>The <code class="language-plaintext highlighter-rouge">pluginClass</code> here for iOS stands for <code class="language-plaintext highlighter-rouge">.h</code> file in Classes folder.</p>
  </li>
</ol>

<h3 id="ios-troubleshooting">iOS Troubleshooting</h3>
<ul>
  <li>run <code class="language-plaintext highlighter-rouge">pod install</code> in ios folder with Runner (helps with <code class="language-plaintext highlighter-rouge">module not found</code> error in Xcode)</li>
  <li>to run a different dart file than <code class="language-plaintext highlighter-rouge">main.dart</code> edit <code class="language-plaintext highlighter-rouge">FLUTTER_TARGET</code> in Xcode in Runner Build Settings.</li>
  <li>check <code class="language-plaintext highlighter-rouge">iOS Deployment Target</code>, 9.0 might be too old for some releases.</li>
</ul>

<h2 id="macos">MacOS</h2>
<p>This tutorial is made for a multiplatform project and it assumes the iOS support is already working.</p>
<ol>
  <li>
    <p>Add support for MacOS in your project by executing <code class="language-plaintext highlighter-rouge">flutter create --platform=macos .</code>
<strong>Warning:</strong> This command will create all files that are automatically created when making new Flutter project. If for some reason you deleted some of them, you might need to get rid of them again.</p>
  </li>
  <li>To link your Rust library with MacOS, <code class="language-plaintext highlighter-rouge">.dylib</code> file type is necessary. To generate it, edit <code class="language-plaintext highlighter-rouge">Cargo.toml</code>, so that it has following structure:
    <div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre> <span class="nn">[lib]</span>
 <span class="py">crate-type</span> <span class="p">=</span> <span class="nn">["dylib"]</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>Then run <code class="language-plaintext highlighter-rouge">cargo build</code> in your <code class="language-plaintext highlighter-rouge">$crate</code> directory. Remember to use the flag <code class="language-plaintext highlighter-rouge">--release</code> to make the lib much smaller.</p>
  </li>
  <li>Move your <code class="language-plaintext highlighter-rouge">.dylib</code> file to <code class="language-plaintext highlighter-rouge">macos</code> folder in your project.</li>
  <li>In <code class="language-plaintext highlighter-rouge">.swift</code> file in <code class="language-plaintext highlighter-rouge">macos/Classes</code> add the dummy method (more about it in <code class="language-plaintext highlighter-rouge">flutter_rust_bridge</code> documentation):
    <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">func</span> <span class="nf">dummyMethodToEnforceBundling</span><span class="p">()</span> <span class="p">{</span>
     <span class="c1">// This will never be executed</span>
     <span class="nf">dummy_method_to_enforce_bundling</span><span class="p">()</span>
 <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Don’t forget to edit <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> and add the MacOS support:
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre> <span class="na">plugin</span><span class="pi">:</span>
     <span class="na">platforms</span><span class="pi">:</span>
       <span class="na">macos</span><span class="pi">:</span> 
         <span class="na">pluginClass</span><span class="pi">:</span> <span class="s">FlutterRustPlugin</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Edit the <code class="language-plaintext highlighter-rouge">.podspec</code> file and add following lines:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre> s.vendored_libraries = "**/*.dylib"
 s.public_header_files = 'Classes**/*.h'
 s.static_framework = true
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Copy the <code class="language-plaintext highlighter-rouge">bridge_generated.h</code> file from <code class="language-plaintext highlighter-rouge">ios</code> folder to <code class="language-plaintext highlighter-rouge">macos/Classes</code>. This file has been generated when enabling support for iOS. To generate it, run: <code class="language-plaintext highlighter-rouge">flutter_rust_bridge_codegen --rust-input $rust_part/src/api.rs --dart-output lib/bridge_generated.dart --c-output macos/Classes/bridge_generated.h</code></li>
</ol>

<h3 id="macos-troubleshooting">MacOS Troubleshooting</h3>
<ul>
  <li>If you run into <code class="language-plaintext highlighter-rouge">no such module</code> error while running the example, enter <code class="language-plaintext highlighter-rouge">example/macos</code> folder in project and execute <code class="language-plaintext highlighter-rouge">pod install</code> in the command line. This installs the missing module.</li>
  <li>If during testing the example you run into <code class="language-plaintext highlighter-rouge">cannot find 'dummy_method_to_enforce_bundling' in scope</code>, run <code class="language-plaintext highlighter-rouge">pod update</code>.</li>
  <li>For other errors, try <code class="language-plaintext highlighter-rouge">pod deintegrate</code> and <code class="language-plaintext highlighter-rouge">pod install</code> to reinstall pods.</li>
  <li>Try deleting all folders from <code class="language-plaintext highlighter-rouge">/Users/&lt;your username&gt;/Library/Developer/Xcode/DerivedData</code> and cleaning your build folder.</li>
</ul>

<h2 id="windows">Windows</h2>
<p>This part of the tutorial assumes the user has generated library files <code class="language-plaintext highlighter-rouge">.dll</code> and <code class="language-plaintext highlighter-rouge">.lib</code> as described in Initial steps.</p>
<ol>
  <li>If your plugin project does not have Windows support activated, execute <code class="language-plaintext highlighter-rouge">flutter create --platform=windows</code> in project root folder:</li>
</ol>

<p><strong>Warning:</strong> This command will create all files that are automatically created when making new Flutter project. If for some reason you deleted some of them, you might need to get rid of them again.</p>

<ol>
  <li>Make a new folder under created in previous point <code class="language-plaintext highlighter-rouge">windows</code> directory, let us refer to it by <code class="language-plaintext highlighter-rouge">$crate</code>.</li>
  <li>Place the <code class="language-plaintext highlighter-rouge">.dll</code> and <code class="language-plaintext highlighter-rouge">.lib</code> files in <code class="language-plaintext highlighter-rouge">$crate</code> directory and change their names to <code class="language-plaintext highlighter-rouge">$crate.dll</code> and <code class="language-plaintext highlighter-rouge">$crate.lib</code>.</li>
  <li>In your <code class="language-plaintext highlighter-rouge">$crate</code> directory create a new file, <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>. Append the following lines to the file:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre> include(../../cmake/$crate.cmake)

 set_property(TARGET ${CRATE_NAME} PROPERTY IMPORTED_LOCATION "${CMAKE_CURRENT_SOURCE_DIR}/$crate.dll")
 set_property(TARGET ${CRATE_NAME} PROPERTY IMPORTED_IMPLIB "${CMAKE_CURRENT_SOURCE_DIR}/$crate.lib")
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>The included <code class="language-plaintext highlighter-rouge">$crate.cmake</code> file will be created in the next steps.</p>
  </li>
  <li>In your root folder, create <code class="language-plaintext highlighter-rouge">cmake</code> directory.</li>
  <li>Under <code class="language-plaintext highlighter-rouge">cmake</code> directory create <code class="language-plaintext highlighter-rouge">$crate.cmake</code> file. Append the following lines to the file:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre> message("-- Linking Rust")
 set(CRATE_NAME "$crate")
 set(CRATE_NAME ${CRATE_NAME} PARENT_SCOPE)
 if(CRATE_STATIC)
   add_library(${CRATE_NAME} STATIC IMPORTED GLOBAL)
 else()
   add_library(${CRATE_NAME} SHARED IMPORTED GLOBAL)
 endif()
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Under <code class="language-plaintext highlighter-rouge">cmake</code> directory create <code class="language-plaintext highlighter-rouge">main.cmake</code> file. Append the following lines to the file:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre> add_subdirectory($crate)
 target_link_libraries(${PLUGIN_NAME} PRIVATE ${CRATE_NAME})
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Edit the <code class="language-plaintext highlighter-rouge">windows/CMakeLists.txt</code> file. Add the following lines:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> include(../cmake/main.cmake)
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>Put this line after <code class="language-plaintext highlighter-rouge">target_link_libraries</code> line.</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre># List of absolute paths to libraries that should be bundled with the plugin.
# This list could contain prebuilt libraries, or libraries created by an
# external build triggered from this build file.
 set(flutter_rust_plugin_bundled_libraries
   "$&lt;TARGET_FILE:${CRATE_NAME}&gt;"
   PARENT_SCOPE
 )
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>Here, change <code class="language-plaintext highlighter-rouge">""</code> to <code class="language-plaintext highlighter-rouge">"$&lt;TARGET_FILE:${CRATE_NAME}&gt;"</code>.</p>
  </li>
  <li>Don’t forget to declare support for windows in <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> file:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre> plugin:
     platforms:
       android:
         package: com.example.flutter_rust_plugin
         pluginClass: FlutterRustPlugin
       windows:
         pluginClass: FlutterRustPluginCApi
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<h3 id="integration-with-dart">Integration with Dart</h3>
<ul>
  <li>Your <code class="language-plaintext highlighter-rouge">.lib</code> folder should have a similar structure (old plugin template):
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  ├── lib
      ├── bridge_generated.dart
      └── flutter_rust_plugin.dart
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>Where <code class="language-plaintext highlighter-rouge">bridge_generated.dart</code> is a file generated using <code class="language-plaintext highlighter-rouge">flutter_rust_bridge_codegen</code> and <code class="language-plaintext highlighter-rouge">flutter_rust_plugin.dart</code> is the main plugin file. For more information on flutter plugin check out the official <a href="https://docs.flutter.dev/development/packages-and-plugins/developing-packages">documentation</a>.</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">flutter_rust_plugin.dart</code> file contains all methods that will be available in the plugin for the users. The libraries is loaded there. Here is an example of code used to load the libraries:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  static const base = 'rust_part';
  static final path = Platform.isWindows? '$base.dll' : 'lib$base.so';
  static late final dylib = Platform.isIOS
        ? DynamicLibrary.process()
        : Platform.isMacOS
        ? DynamicLibrary.executable()
        : DynamicLibrary.open(path);
    static late final api = RustPartImpl(dylib);
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>The <code class="language-plaintext highlighter-rouge">RustPartImpl</code> is the name of the class in <code class="language-plaintext highlighter-rouge">bridge_generated.dart</code>, the one class that extends <code class="language-plaintext highlighter-rouge">FlutterRustBridgeBase</code>. In order to call the method from library, use:</p>
    <pre><code class="language-dart=">await api.methodName();
</code></pre>
  </li>
</ul>

<hr />
<h3 id="references">References</h3>
<ul>
  <li>iOS: This tutorial was created using the official documentation of <a href="http://cjycode.com/flutter_rust_bridge/integrate.html">flutter_rust_bridge</a> and <a href="https://mozilla.github.io/firefox-browser-architecture/experiments/2017-09-06-rust-on-ios.html">mozilla github post</a>. If something is not clear, checking out these sources might help you.</li>
  <li>Windows: This tutorial was created using the official documentation of <a href="http://cjycode.com/flutter_rust_bridge/integrate.html">flutter_rust_bridge</a> and <a href="https://github.com/mouEsam/rust_cryptor">this</a> proof of concept for Flutter+Rust plugin. If something is not clear, checking out these sources might help you.</li>
</ul>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2022/09/22/the-various-angles-of-user-interfaces/">
        The various angles of User Interfaces
      </a>
    </h1>

    <time datetime="2022-09-22T20:38:32+00:00" class="post-date">22 Sep 2022</time>
    
    <p class="post-author">
    by
    
    Michal Pietrus
    
    </p>
    

    <h2 id="introduction">Introduction</h2>

<p>Since decades, especially the cinema industry tries to explore the concept of human being and machine seamless interaction. HAL 9000, J.A.R.V.I.S., to just name a few, they emerged to support human decision processes or simply to help execute them. Both of these AI’s used speech recognition and voice talk to communicate with humans. This is however not the only way to make the seamless interaction with a machine, but the only one that can be seen or heard (so the viewer can feel it using his senses) and at the same time that does not need any other peripheral device like keyboard or mouse. Not only that, it relies on the same sense as in human to human communication. From another angle, the most effective way for communication would be to make interactions by exchanging the “thoughts” straight from the human brain. It would be the fastest, sense-less approach.</p>

<p>While the cinema industry is usually ahead with their ideas in comparison to the tech possibilities at a given time, ocasionally some become the reality. In the recent years a concept of a chatbot has been employed at scale by various industries. Chatbot is a trained algorithm, to support human decision processes and interacts via text or voice. Both can be translated into computer command and the result of executing it translated backwards into human language, either displayed or said. While this way of interacting with machine has still its drawbacks, it is much more pleasant and way more faster.</p>

<h2 id="express-the-intention">Express the intention</h2>

<p>To be properly understood by the other side while communicating, it is all about expressing intention by making clear statements. Humans tend to use contexts in discussions and are capable to grasp them, as opposed to machines. If the intention expression is however context-less, it is likely the machine will do what was intended by human. Being context-less is not a trivial task for humans, especially when context is present in almost any human to human interaction. It becomes an unnoticeable habit and yet, conversation parties understand each other. Humans have, however, yet another capability: they can adapt to the evironment boundaries, they can learn. Thus, while living in a context-rich environment, they have learned that digital space is different, more context-less oriented, especially while interacting with a machine and looking for an information. Search for information system capability is an excellent example. The more unambigious the intention expression is, the better quality the search results are. The search capability is fundamental as it may express various intentions. It can navigate through the information, distill the subset of an information or discover the unknown parts of the information. Therefore proper searching inherently becomes essential skill.</p>

<p>A counter-example to the search capability of a system is the user interface (UI). UI’s emerged to organize the information in a pleasant way, so to help humans navigate through the diss-information. Categorize it, distill and order according to the needs and personal preferences. Make it easily accessible. Where amount of the information increases, however, the organization and navigation enters the complexity. The more information to maintain, the more burden to cope with. Apart from that, organization is usually a personal, so customizable property.</p>

<p>While UI’s are the gateways to information management, they are opaque to what they are applied to. So whether this is an operating system (OS) UI, or just an extension to the OS, so the application, they tend to simplify management of the information. Important characteristics of the app is that it expresses an intention by providing service(s). Service can be anything that has the outcome of enriching the human needs, ie. buy a ticket.</p>

<p>UI’s are the answer to weak system search capabilities problem. Systems with strong search capabilities may reduce the need for fat UI’s. Fat UI represents a state where the information management has been done in contradiction to the human needs. An overloaded/overbloated UI not only does not serve its purpose, but also reduces the pleasure of making any interaction with it.</p>

<p>Expressing the intention involves human senses. Employing the senses create interactions through the underlying technology that is the gateway to digital world. This technology initially was able to provide “interface” solely for touch sense. Touch sense is however the least efficient, because it is time consuming activity to express the intention through employing it. It is now the time as it is evolving at scale towards more efficient senses like speech. Typing a sentence on a keyboard utilizing touch sense <a href="https://news.stanford.edu/2016/08/24/stanford-study-speech-recognition-faster-texting/">is three times slower</a> than expressing it through human language along with speech recognition. It is likely the gap between these two will increase over time as the technology behind it becomes more mature. This is not the only gain, because if the touch sense is not involved, it can be occupied by another activities.</p>

<h2 id="the-overwhelmed-amount-of-surrounding-information">The overwhelmed amount of surrounding information</h2>

<p>Individuals on a daily basis interact with various type of services and the outcome of such interactions is usually more information to be managed. Whether this is aforementioned buying a ticket operation, pumping a car on a gas station, or even issuing an agreement with new trade partner, it all produces new information. If furthermore this done in a digital world, the outcome is not written on a piece of paper that can be stored in a desired place, at least initially. The digital world, however, offers similar mechanims to maintain the information. Operating systems and applications managed through UI’s have coined solutions that tend to mimic the real world. Files, an analogy to a piece of paper. Directory, an analogy to a catalog. It all helps in information organization and categorization. When done, it reduces the amount of time to actually search the information, to some extent. It is however always limited to the categorization problem. In other words to get the information that crosses the boundaries, or crosses multiple categories, much more steps need to be done to actually get the meaningful result. So to enter each category, check if it is there, go to next one and repeat. A time consuming process. Note there might be many categories and these are usually personal, so in other words what worked for one person, might not work the same way for another person. With the increasing amount of information and categories it invevitably ends up in diffculties while searching, because more and more activities need to be done.</p>

<p>Consider such example:</p>
<blockquote>
  <p>A car owner wants to sell it. The buyer, so the new owner will demand a history of the car, including proof-of-provenance, insurance, all receipts from repairs, replacements etc. Although all this information is related to a car, it is not in primary relationship to a car. Insurance is a consequence of interacting with insurance company, receipts of repairs a result of interacting with car mechanic and so on. In many cases all this information has been delivered to the car owner via plain old email… While email box nicely aggregates information and provides search features, it is unfortunately context-less searching. In other words to find all the car related documents, car owner needs to provide some context, ie. mechanic name or his email, name of the insurance company or its email. Not only that, the current car owner needs to remember any type of document that is related to a car!</p>
</blockquote>

<p>Consider another example:</p>
<blockquote>
  <p>Any company has to run bookkeeping, so every time period, ie. a month or quarter, a summary needs to be made and a tax paid. A summary, so a revenue (issued invoices) minus the operational costs that gives the income, a foundation to calculate the tax. Both, the revenue and operational costs are the consequence of company interactions with clients and suppliers. Interactions happen in many contexts and through various relationships. When the time comes, all the documents for tax calculation need to be collected. Sounds familiar? A very similar case to the previous example.</p>
</blockquote>

<p>While information categorization can be applied in various contexts, it will be always personal. A person in digital space can use email labels or tags, directory structure on hard(pen) drive, or have no organization at all. Note all these activities lead to UI’s and managing information through UI’s. As discussed above, UI’s serve their purpose for information management until they don’t. The following chart shows the relationship between amount of information to be managed and UI capabilities to handle it.</p>

<p><a href="/static/img/20220922/information_to_ui.png"><img src="/static/img/20220922/information_to_ui.png" alt="" /></a></p>

<p>In other words in a contextual, cross category information searches, no UI will play well, as UI is limited by its primary strength – the information categorization behavior. The more information to be managed, the less effective UI becomes.</p>

<h3 id="app-ism--current-approach-to-information-management">“app-ism” – current approach to information management</h3>

<p>Any operating system (OS) relies on extensions, the applications (apps) that enrich the OS capabilities. Through them users can express their intent. By adding more capabilities, more information need to be managed or remembered. Cross category information searches are not possible, because apps do not expose proper interfaces for such activities. In fact, even if they would, the quality of such cross-boundary searches will lack the information contextuality. This is again the weak system search capabilities problem.</p>

<h2 id="summary">Summary</h2>

<p>User interfaces are powerful and flexible creatures that exist to make the human interactions with machines pleasant. This is however not always the most effective approach, especially in the information management problem that includes the search capability. User interfaces, by their nature will lack in complex, cross-boundary searches due to either missing information or context-less information.</p>

<p>Systems that are capable to interact with humans by leveraging more human senses will have the prevalence over systems that rely on classic user interfaces – that involve only touch sense. At the same time, involving more senses will reduce the complexity of user interface. A well-searchable system that has strong search capabilities, along with speech recognition would certainly redefine the attitude to the need of user interface as it is framed today.</p>


  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2016/11/07/interface-designer-manifesto/">
        Software Interface Designer Manifesto
      </a>
    </h1>

    <time datetime="2016-11-07T21:38:32+00:00" class="post-date">07 Nov 2016</time>
    
    <p class="post-author">
    by
    
    Michal Pietrus
    
    </p>
    

    <ol>
  <li>
    <p>A program without interface is just machine code. Machines understand everything tailored to language rules. They don’t care about interfaces, but humans do. <em>Interfaces are for humans</em>.</p>
  </li>
  <li>
    <p>Interfaces are read many times more than are written. The weaker an interface is, the more diffcult it is to understand its intention. <em>Respect other humans</em>.</p>
  </li>
  <li>
    <p>Various tools, patterns and techniques may be utilised to create interface, but only human can blend it together with appropriate proportions. <em>That is a good interface</em>.</p>
  </li>
  <li>
    <p>Interface designer doesn’t start on 09:00 am and stops 05:00 pm. Creative work is not a machine with on/off button. When the conditions are good, good interface will appear in 2 hours. When conditions are bad, 2 days may be insufficient to create a good one. Don’t push on it.</p>
  </li>
  <li>
    <p>Creating interfaces, despite its science nature, is an art. Therefore may be described as beautiful or awful, good or bad, strong or weak or whatever adjective is suitable. Judging interfaces requires both, wisdom and experience.</p>
  </li>
  <li>
    <p>SOLID, TDD, DRY, CLEAN: they exist for a reason. <em>Mantaining good interfaces is a pleasure</em>. Otherwise there’s always WTF.</p>
  </li>
</ol>

  </article>
  
</div>

<div class="pagination">
  
  <a class="pagination-item older" href="/page2">Older</a>
  
  
  <span class="pagination-item newer">Newer</span>
  
</div>

      </main>

      <footer class="footer">
        <small>
          ArgonAUTHs <time datetime="2023-01-29T22:03:57+00:00">2023</time>. EUPL 1.2.
        </small>
      </footer>
    </div>
    <script>
      var show = function (elem) {
        elem.classList.add('is-visible');
      };

      // Hide an element
      var hide = function (elem) {
        elem.classList.remove('is-visible');
      };

      // Toggle element visibility
      var toggle = function (elem) {
        elem.classList.toggle('is-visible');
      };

      document.querySelector("#nav-toggle").addEventListener("click", function(event) {
        var content = document.querySelector(".pull");
        if (!content) return;

        toggle(content);
      });

    </script>
  </body>
</html>
